### Домашнее задание №14 (PAM)
#### 1. Настроил виртуальну машину с Centos 7. Hostname: server. Создал пару rsa ключей, виртуальная машина доступна по public ключу. Vagrantfile прилагается.
```console
[kita@devops OTUS]$ ssh vagrant@192.168.2.71
Last login: Mon Oct 31 17:31:57 2022 from 192.168.2.130
[vagrant@server ~]$ sudo useradd day
```
#### 2. В виртуальной машине создал пользователей day, night, friday. Пользователя day добавил в группы admin, night, wheel.
```console
[root@server vagrant]# id day -Gn
day wheel night admin
```
#### 3. Для того, чтобы выполнить условия домашнего задания был выбран вариант написания скрипта для модуля pam_exec.so, удовлетворяющий следующим условиям:
- скрипт проверяет, состоит ли логирующийся пользователь в группе __admin__. Если состоит, то скрипт возвращает 0.
- если пользователь не состоит в группе __admin__, то скрипт проверяет какой сегодня день. Если рабочий день, то скрипт возвращает 0. 
- в случае, если сегодня Sun или Sat, скрипт возвращает 1, модуль pam_exec запрещает логирование на хосте.

#### 4. Разбор скрипта:
- обьявлены и инициализированы 2 переменные:
    - admin - хранит название целевой группы;
    - flag - переменная, изменяющая свое значение в случае нахождения группы admin в перечне групп лоирующегося пользователя;
- циклом for пошагово сравниваются группы логируюшегося пользователя с целевой группой. В случае совпадения переменная flag принимает значение 1.
- в случае, если переменная flag = 1, скрипт заканчивает свою работу с выходом 0;
- в случае, если переменная flag = 0, далее рассматривается день недели, когда пользователь пытается залогироваться на хосте;
- оператор ветвления if проверяет, какой сегодня день недели. Если сегодня суббота или воскресение, скрипт завершает работу с кодом выхода 1;
- в противном случае, скрипт завершает работу с кодом выхода 0.

#### 4. В целях проверки работы скрипта были сделаны следующие тесты:
- Для выполнения тестов в выводах скрипта добавлены отладочные __echo__!  
1. Логирование пользователя day, который присутствует в группе __admin__:
```console
[root@server vagrant]# ./logging.sh day   
You are in group Admin, continue logging...
```
2. Логирование пользователя night, сегодня рабочий день:
```console
[root@server vagrant]# ./logging.sh night
Today is working day, you can login,  night
```
3. В целях проверки логирвания в выходной день, изменим Sat на Wed:
```console
[root@server vagrant]# ./logging.sh day
You are in group Admin, continue logging...

[root@server vagrant]# ./logging.sh night
Today is day off
```

#### 5. Путь на указанный скрипт нужно указать в кофигурационном файле /etc/pam.d/sshd:
```console
account required pam_nologin.so
account required pam_exec.so /usr/local/bin/logging.sh
```